<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BCA Sem 5 — Open Feedback Form</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root{--blue:#0b5ed7;--muted:#6c757d;}
  body{font-family:Roboto,Arial,sans-serif;background:#f5f8ff;margin:0;color:#222}
  .wrap{max-width:980px;margin:28px auto;padding:22px}
  header{background:#0d47a1;color:#fff;padding:18px;border-radius:8px 8px 0 0}
  header h1{margin:0;font-size:20px}
  .card{background:#fff;border-radius:8px;padding:22px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
  label{display:block;margin:12px 0 6px;font-weight:600}
  select, input[type=text]{width:100%;padding:10px;border-radius:6px;border:1px solid #d0d7e6;font-size:15px}
  .row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  .col{flex:1;min-width:200px}
  .btn{display:inline-block;background:var(--blue);color:#fff;padding:10px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
  .btn.secondary{background:#6c757d}
  .note{color:var(--muted);font-size:13px;margin-top:10px}
  .admin{margin-top:14px}
  footer{margin-top:18px;color:#666;font-size:13px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>CHRIST COLLEGE, VIZHINJAM — Student Feedback</h1>
    </header>

    <div style="margin-top:18px" class="card">
      <h2 style="color:var(--blue);margin:0 0 6px">BCA – Semester 5</h2>
      <p class="note"><strong>Course:</strong> BCA &nbsp; | &nbsp; <strong>Semester:</strong> 5 &nbsp; | &nbsp; <strong>Academic Year:</strong> 2024–25</p>

      <label for="teacherSelect">Teacher & Subject *</label>
      <select id="teacherSelect" aria-label="Select teacher">
        <option value="">-- Select teacher & subject --</option>
      </select>

      <div class="row" style="margin-top:14px;">
        <div class="col">
          <button id="openFormBtn" class="btn" style="width:100%">Open Feedback Form</button>
        </div>
        <div class="col">
          <button id="backBtn" class="btn secondary" style="width:100%">Back to Departments</button>
        </div>
      </div>

      <div class="note" id="statusNote">0 of 6 remaining</div>

      <div class="admin">
        <button id="resetBtn" class="btn secondary" style="background:#e74c3c">Reset (Admin)</button>
        <span class="note" style="margin-left:8px">Use to clear local test state</span>
      </div>

      <footer>
        <div style="margin-top:10px">If the web app opens but the teacher isn't pre-filled in the form, make sure your Apps Script reads `e.parameter.teacher` from the URL and uses it to preselect the teacher.</div>
      </footer>
    </div>
  </div>

<script>
/*
  Launcher for BCA Sem5 feedback.
  - Replaces the teacher options with the confirmed list.
  - Opens your GAS web app in new tab with query params.
  - Update GAS_URL below if needed.
*/

const GAS_URL = "https://script.google.com/macros/s/AKfycbyfRrHYglcjGC2GmrlhRUJLVqyKUeiZo59d-Me6GwoYeqLQx458QVBguTKDCxJsbRl3CQ/exec";

// final teacher list (exact spelling)
const teacherSubjects = [
  { teacher: "Ms Neethu John", subject: "Design Analysis & Algorithm" },
  { teacher: "Ms Sreelekshmi S L", subject: "PHP & MySQL" },
  { teacher: "Ms Sreelekshmi S L", subject: "Cloud Computing (Modules 1 & 2)" },
  { teacher: "Ms Lekshmi Chandran C P", subject: "Visual Programming" },
  { teacher: "Ms Lekshmi Chandran C P", subject: "Cloud Computing (Modules 3 & 4)" },
  { teacher: "Mr Umesh S R", subject: "Principles of Management" }
];

const COURSE = "BCA";
const SEMESTER = "5";
const ACADEMIC_YEAR = "2024–25"; // en-dash as you used earlier

// DOM
const select = document.getElementById("teacherSelect");
const openBtn = document.getElementById("openFormBtn");
const backBtn = document.getElementById("backBtn");
const resetBtn = document.getElementById("resetBtn");
const statusNote = document.getElementById("statusNote");

// load options
function populateTeachers(){
  // clear existing (but preserve first placeholder)
  select.innerHTML = "<option value=''>-- Select teacher & subject --</option>";
  teacherSubjects.forEach((t) => {
    const opt = document.createElement("option");
    opt.value = `${t.teacher} – ${t.subject}`; // use EN DASH if you like; here we use U+2013 char
    opt.textContent = `${t.teacher} – ${t.subject}`;
    select.appendChild(opt);
  });

  // show remaining (if you want to compute dynamic remaining by looking sheet you'll need server call)
  statusNote.textContent = `${teacherSubjects.length} of ${teacherSubjects.length} remaining`;
}

// open GAS web app with query params
function openFeedback(){
  const val = select.value;
  if(!val){
    alert("Please select a teacher first.");
    return;
  }

  // Build query params
  const params = new URLSearchParams({
    teacher: val,
    course: COURSE,
    semester: SEMESTER,
    academicYear: ACADEMIC_YEAR
  });

  const url = GAS_URL + "?" + params.toString();

  // open new tab
  window.open(url, "_blank");
}

// go back to departments page (adjust filename if needed)
function goBack(){
  // adjust to your department selection filename
  location.href = "select_department.html";
}

// admin reset (local storage example — not mandatory)
function adminReset(){
  // if you used any localStorage keys during testing you can clear them here
  try {
    localStorage.removeItem("remainingTeachers");
  } catch(e){}
  populateTeachers();
  alert("Reset complete. Reload the page if required.");
}

// hooks
openBtn.addEventListener("click", openFeedback);
backBtn.addEventListener("click", goBack);
resetBtn.addEventListener("click", adminReset);

// init
populateTeachers();
</script>
</body>
</html>
